import{d as e,r as a,o as l,B as t,c as o,e as i,$ as s,w as u,a5 as r,l as n,a6 as p,a7 as m,g as c,t as v,aB as d,a8 as f,aK as _}from"./index.BQLDJCDE.js";import{E as g}from"./el-card.CTX5lC-5.js";import{E as y}from"./el-pagination.C2oQGxLD.js";import{E as j}from"./el-tag.X3ElC6JM.js";import"./el-select.D09r31B5.js";import"./el-scrollbar.PI2VZJ2b.js";import"./el-popper.CpH5HJMu.js";import{E as x,a as h}from"./el-table-column.Bm4IobD1.js";import"./el-tooltip.l0sNRNKZ.js";import{E as C}from"./el-dialog.4Gr8TKyA.js";import{g as w,A as b,U as k,D as V}from"./temp.DwHkzyMy.js";import{_ as z}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./isEqual.DADUiilY.js";import"./_initCloneObject.C1ttGGcT.js";import"./strings.Dv2nQ1TS.js";import"./castArray.CrTKd7It.js";import"./debounce.7DwFOk0p.js";import"./index.DQmdMWe2.js";import"./index.DNViV2ks.js";import"./index.CclK_oo-.js";import"./use-dialog.BsWeMcUI.js";import"./refs.Cs1Biyat.js";const E={class:"dialog-footer"},B=z(e({__name:"template",setup(e){const z=a([]),B=a(""),T=a(""),I=a(""),K=a(!1),O=a(),S=a(""),U=a("1");async function D(){const{data:e}=await w();z.value=e}l((async()=>{D()}));const A=()=>{S.value="添加模版",T.value="",I.value="",U.value="1",K.value=!0},J=async()=>{"添加模版"==S.value?(await b({filename:T.value.trim(),text:I.value.trim()}),d.success("添加成功")):(await k({filename:T.value.trim(),oldname:B.value.trim(),text:I.value.trim()}),d.success("更新成功")),D(),T.value="",I.value="",K.value=!1},R=a([]),$=e=>{R.value=e},q=()=>{0!==R.value.length&&_.confirm("你是否要删除选中这些 ?","提示",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((()=>{for(let e=0;e<R.value.length;e++)V({filename:R.value[e].file}),z.value=z.value.filter((a=>a.file!==R.value[e].file));d({type:"success",message:"删除成功"})}))},F=a(1),G=a(10),L=e=>{G.value=e},M=e=>{F.value=e},P=t((()=>{const e=(F.value-1)*G.value,a=e+G.value;return z.value.slice(e,a)}));return(e,a)=>{const l=r,t=p,w=C,b=h,k=j,U=x,R=y,W=g;return i(),o("div",null,[s(w,{modelValue:K.value,"onUpdate:modelValue":a[3]||(a[3]=e=>K.value=e),title:S.value,width:"80%"},{footer:u((()=>[n("div",E,[s(t,{onClick:a[2]||(a[2]=e=>K.value=!1)},{default:u((()=>a[6]||(a[6]=[m("关闭")]))),_:1,__:[6]}),s(t,{type:"primary",onClick:J},{default:u((()=>a[7]||(a[7]=[m("确定")]))),_:1,__:[7]})])])),default:u((()=>[s(l,{modelValue:I.value,"onUpdate:modelValue":a[0]||(a[0]=e=>I.value=e),placeholder:"模版内容",rows:10,type:"textarea",style:{"margin-bottom":"10px"}},null,8,["modelValue"]),s(l,{modelValue:T.value,"onUpdate:modelValue":a[1]||(a[1]=e=>T.value=e),placeholder:"模版文件名"},null,8,["modelValue"])])),_:1},8,["modelValue","title"]),s(W,null,{default:u((()=>[s(t,{type:"primary",onClick:A},{default:u((()=>a[8]||(a[8]=[m("添加模版")]))),_:1,__:[8]}),a[14]||(a[14]=n("div",{style:{"margin-bottom":"10px"}},null,-1)),s(U,{ref_key:"table",ref:O,data:c(P),style:{width:"100%"},onSelectionChange:$},{default:u((()=>[s(b,{type:"selection",fixed:"",prop:"ID",label:"id"}),s(b,{prop:"file",label:"模版文件名"},{default:u((e=>[s(k,{type:"success"},{default:u((()=>[m(v(e.row.file),1)])),_:2},1024)])),_:1}),s(b,{prop:"create_date",label:"创建时间",sortable:""}),s(b,{fixed:"right",label:"操作",width:"120"},{default:u((e=>[s(t,{link:"",type:"primary",size:"small",onClick:a=>(e=>{for(let a=0;a<z.value.length;a++)z.value[a].file===e.file&&(S.value="编辑模版",T.value=z.value[a].file,B.value=T.value,I.value=z.value[a].text,K.value=!0)})(e.row)},{default:u((()=>a[9]||(a[9]=[m("编辑")]))),_:2,__:[9]},1032,["onClick"]),s(t,{link:"",type:"primary",size:"small",onClick:a=>{return l=e.row,void _.confirm(`你是否要删除 ${l.file} ?`,"提示",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((async()=>{await V({filename:l.file,type:l.type}),d({type:"success",message:"删除成功"}),D()}));var l}},{default:u((()=>a[10]||(a[10]=[m("删除")]))),_:2,__:[10]},1032,["onClick"])])),_:1})])),_:1},8,["data"]),a[15]||(a[15]=n("div",{style:{"margin-top":"20px"}},null,-1)),s(t,{type:"info",onClick:a[4]||(a[4]=e=>{f((()=>{z.value.forEach((e=>{O.value.toggleRowSelection(e,!0)}))}))})},{default:u((()=>a[11]||(a[11]=[m("全选")]))),_:1,__:[11]}),s(t,{type:"warning",onClick:a[5]||(a[5]=e=>{O.value.clearSelection()})},{default:u((()=>a[12]||(a[12]=[m("取消选择")]))),_:1,__:[12]}),s(t,{type:"danger",onClick:q},{default:u((()=>a[13]||(a[13]=[m("批量删除")]))),_:1,__:[13]}),a[16]||(a[16]=n("div",{style:{"margin-top":"20px"}},null,-1)),s(R,{onSizeChange:L,onCurrentChange:M,"current-page":F.value,"page-size":G.value,layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,20,30,40],total:z.value.length},null,8,["current-page","page-size","total"])])),_:1,__:[14,15,16]})])}}}),[["__scopeId","data-v-0c7c8c5b"]]);export{B as default};
